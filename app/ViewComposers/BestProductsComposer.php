<?phpnamespace App\ViewComposers;use App\Models\Order;use App\Models\Product;use Illuminate\View\View;class BestProductsComposer{    public function compose(View $view) {        $productsArray = [];        $bestProductsIds = Order::get()->map->products->flatten()->map->pivot->mapToGroups(function ($pivot) {            return [$pivot->product_id => $pivot->quantity];        })->map->sum()->sortDesc()->take(3)->keys()->toArray();        $products = Product::whereIn('id',$bestProductsIds)->get();        $view->with('bestProducts', $products);    }}